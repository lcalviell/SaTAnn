% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/satann.R
\name{select_quantify_ORFs}
\alias{select_quantify_ORFs}
\title{Select and quantify ORF translation}
\usage{
select_quantify_ORFs(results_ORFs, P_sites, P_sites_uniq,
  cutoff_cums = NA, cutoff_pct = 2, cutoff_P_sites = NA,
  optimiz = FALSE, scaling = TRUE)
}
\arguments{
\item{results_ORFs}{Full list of detected ORFs, from \code{detect_translated_ORFs}}

\item{P_sites}{GRanges object with P_sites positions}

\item{P_sites_uniq}{GRanges object with uniquely mapping P_sites positions}

\item{cutoff_cums}{cutoff to select ORFs until <x> percentage of total gene translation. Defaults to 99}

\item{cutoff_pct}{minimum percentage of total gene translation for an ORF to be selected. Defaults to 1}

\item{cutoff_P_sites}{minimum number of P_sites assigned to the ORF to be selected. Defaults to 10}

\item{optimiz}{(Beta) should numerical optimization (minimizing distance between observed coverage and expected coverage) 
be used to quantify ORF translation? Defaults to FALSE}

\item{scaling}{Additional scaling value taking into account total signal on the detected ORFs to adjust quantification estimates (recommended). Defaults to TRUE}
}
\value{
modified \code{results_ORFs} object with the selected ORFs including quantification estimates.
}
\description{
This function selects a subset of detected ORFs and quantifies their translation
}
\details{
ORFs are first selected using the same method as in the \code{select_txs} function, but 
using ORF features (ORF structures are treated as transcript structures).\cr
Ribo-seq coverage (reads/length) on bins and junctions (set to a length of 60) is used to derive a scaling factor (0-1) for each ORF,
which indicates how much of the ORF coverage can be assigned to such ORF (1 when no other ORF is present). 
When no unique features are present on an ORF, an adjusted scaling value is calculated subtracting coverage expected from a ORF with a unique feature. 
When no unique features are present on any ORF, scaling values are calculated assuming uniform coverage on each ORF.\cr
ORFs are then further filtered to exclude lowly translated ORFs and quantification/selection is re-iterated until no ORF is further filtered out. 
Percentage of total gene translation and length-adjusted quantification estimates are produced.
More details about the quantificatin procedure can be found in the SaTAnn manuscript.\cr\cr
Additional columns are added to the ORFs_tx object:\cr
\code{TrP}: TrP_raw values (spectral coefficient) from \code{detect_translated_ORFs} divided by the ORF scaling value.\cr
\code{ORF_pct_TrP}:  Percentage of gene translation output for the ORF, derived using TrP values.\cr
\code{ORF_pct_TrP_pN}: Percentage of gene translation ouptut (adjusted by length) for the ORF, derived using TrP values.\cr
\code{P_sites}: P_sites_raw value from \code{detect_translated_ORFs} divided by the ORF scaling value.\cr
\code{ORF_pct_P_sites}: Percentage of gene translation output for the ORF, derived using P_sites values.\cr
\code{ORF_pct_P_sites_pN}: Percentage of gene translation ouptut (adjusted by length) for the ORF, derived using P_sites values.\cr
\code{unique_features_reads}:  initial number of reads on each unique ORF feature. \code{NA} when no unique feature is present.\cr
\code{adj_unique_features_reads}:  final number of reads on each unique ORF feature after the ORF filtering/quantification procedure. \code{NA} when no unique feature is present.\cr
\code{scaling_factors}: Set of 3 scaling factors assigned to the ORF using intial unique ORF features, after adjusting for the presence of ORFs with no unique features, 
and final scaling factor after correcting for total Ribo-seq coverage on the gene.
}
\seealso{
\code{\link{detect_translated_orfs}}, \code{\link{select_txs}}
}
\author{
Lorenzo Calviello, \email{calviello.l.bio@gmail.com}
}
\keyword{SaTAnn}
